<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Admin ‚Äî Painel de Controle</title>
    <style>
        body { font-family: 'Segoe UI', Arial; background: #f4f7fb; color: #17202a; padding: 20px; }
        .container { max-width: 1100px; margin: auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        h1 { color: #123e7a; border-bottom: 2px solid #e3e8f0; padding-bottom: 10px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { padding: 12px; border: 1px solid #e3e8f0; text-align: left; font-size: 14px; }
        th { background: #f0f5ff; color: #334155; }
        tr:hover { background-color: #f8fafc; }
        .badge { padding: 4px 8px; border-radius: 4px; font-weight: bold; font-size: 12px; }
        .badge-a { background: #dcfce7; color: #166534; } /* Aprovado */
        .badge-b { background: #fee2e2; color: #991b1b; } /* Reavaliar */
    </style>
</head>
<body>
    <div class="container">
        <h1>üõ†Ô∏è Resultados do Question√°rio T√©cnico</h1>
        <div id="content">Carregando submiss√µes...</div>
    </div>

<script>
(async () => {
    try {
        const res = await fetch('http://localhost:3000/submissions');
        if(!res.ok) throw new Error('N√£o foi poss√≠vel conectar ao servidor');
        
        const data = await res.json();
        const contentDiv = document.getElementById('content');

        if(data.length === 0) {
            contentDiv.innerHTML = '<p>Nenhum t√©cnico realizou o teste ainda.</p>';
            return;
        }

        let html = `<table>
            <thead>
                <tr>
                    <th>Nome</th>
                    <th>Idade</th>
                    <th>Acertos</th>
                    <th>Classifica√ß√£o</th>
                    <th>Data/Hora</th>
                    <th>Respostas Detalhadas</th>
                </tr>
            </thead>
            <tbody>`;

        data.forEach(item => {
            const dataFormatada = new Date(item.data_resposta).toLocaleString('pt-BR');
            const classeBadge = item.classificacao === 'A' ? 'badge-a' : 'badge-b';
            
            html += `<tr>
                <td><b>${escapeHtml(item.nome)}</b></td>
                <td>${item.idade}</td>
                <td>${item.acertos} / 20</td>
                <td><span class="badge ${classeBadge}">${item.classificacao}</span></td>
                <td>${dataFormatada}</td>
                <td><small style="color:#64748b">${item.respostas || 'N/A'}</small></td>
            </tr>`;
        });

        html += '</tbody></table>';
        contentDiv.innerHTML = html;

    } catch(e) {
        document.getElementById('content').innerHTML = `<div style="color:red">Erro: ${e.message}</div>`;
    }

    function escapeHtml(s) { 
        return String(s || '').replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;'); 
    }
})();
</script>
</body>
</html>